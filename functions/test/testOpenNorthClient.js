'use strict'

var expect = require('chai').expect;
var openNorthClient = require('../opennorthclient');

const json = JSON.parse(`{"meta": {"total_count": 5, "previous": null, "limit": 20, "offset": 0, "next": null}, "objects": [{"source_url": "http://www1.toronto.ca/wps/portal/contentonly?vgnextoid=e53332d0b6d1e310VgnVCM10000071d60f89RCRD", "party_name": "", "personal_url": "", "first_name": "John", "offices": [{"tel": "1 416 397-2489", "fax": "1 416 338-7125"}], "representative_set_name": "Municipal councils without subdivisions in Canada", "photo_url": "http://www1.toronto.ca/City%20Of%20Toronto/Office%20of%20the%20Mayor/John%20Tory/Photo%20Gallery/john-tory-2014-crop3_medium_180wide.jpg", "related": {"boundary_url": "/boundaries/census-subdivisions/3520005/", "representative_set_url": "/representative-sets/campaign-set-4/"}, "email": "mayor_tory@toronto.ca", "extra": {"address": "Toronto City Hall\\n2nd Floor, 100 Queen Street West\\nToronto ON  M5H 2N2", "validation": "TRUE", "organization": "Toronto, City Council", "office_type": "legislature", "twitter": "https://twitter.com/johntory"}, "district_name": "Toronto", "name": "John Tory", "elected_office": "Mayor", "last_name": "Tory", "url": "http://www1.toronto.ca/wps/portal/contentonly?vgnextoid=e53332d0b6d1e310VgnVCM10000071d60f89RCRD", "gender": ""}, {"source_url": "https://www.toronto.ca/ext/open_data/catalog/data_set_files/Councillor%20Contact%20Data%20November%202%202017.xlsx", "party_name": "", "personal_url": "http://www1.toronto.ca/wps/portal/contentonly?vgnextoid=e53332d0b6d1e310VgnVCM10000071d60f89RCRD", "first_name": "John", "offices": [{"tel": "1 416 397-2489", "fax": "1 416 338-7125", "postal": "Toronto City Hall\\n2nd Floor, 100 Queen Street West\\nToronto ON  M5H 2N2", "type": "legislature"}], "representative_set_name": "Toronto City Council", "photo_url": "http://www1.toronto.ca/City%20Of%20Toronto/Office%20of%20the%20Mayor/John%20Tory/Photo%20Gallery/john-tory-2014-crop3_medium_180wide.jpg", "related": {"boundary_url": "/boundaries/census-subdivisions/3520005/", "representative_set_url": "/representative-sets/toronto-city-council/"}, "email": "mayor_tory@toronto.ca", "extra": {"twitter": "https://twitter.com/johntory"}, "district_name": "Toronto", "name": "John Tory", "elected_office": "Mayor", "last_name": "Tory", "url": "http://www1.toronto.ca/wps/portal/contentonly?vgnextoid=e53332d0b6d1e310VgnVCM10000071d60f89RCRD", "gender": ""}, {"source_url": "https://www.toronto.ca/ext/open_data/catalog/data_set_files/Councillor%20Contact%20Data%20November%202%202017.xlsx", "party_name": "", "personal_url": "", "first_name": "Joe", "offices": [{"tel": "1 416 392-4044", "fax": "1 416 392-4130", "postal": "Toronto City Hall\\n100 Queen Street West, Suite C50\\nToronto ON  M5H 2N2", "type": "legislature"}], "representative_set_name": "Toronto City Council", "photo_url": "http://www1.toronto.ca/City%20Of%20Toronto/City%20Clerks/Councillors/Files/images/j-cressy.jpg", "related": {"boundary_url": "/boundaries/toronto-wards/trinity-spadina-20/", "representative_set_url": "/representative-sets/toronto-city-council/"}, "email": "Councillor_Cressy@toronto.ca", "extra": {}, "district_name": "Trinity-Spadina (20)", "name": "Joe Cressy", "elected_office": "Councillor", "last_name": "Cressy", "url": "http://www1.toronto.ca/wps/portal/contentonly?vgnextoid=2d329a50a6689410VgnVCM10000071d60f89RCRD&vgnextchannel=c3a83293dc3ef310VgnVCM10000071d60f89RCRD", "gender": ""}, {"source_url": "https://www.ola.org/en/members/current/contact-information", "party_name": "New Democratic Party of Ontario", "personal_url": "", "first_name": "Jessica", "offices": [{"tel": "1 416 325-1620", "type": "legislature"}, {"tel": "1 416 535-7206", "type": "constituency"}], "representative_set_name": "Legislative Assembly of Ontario", "photo_url": "https://www.ola.org/sites/default/files/member/profile-photo/jessica_bell.jpg", "related": {"boundary_url": "/boundaries/ontario-electoral-districts-representation-act-2015/university-rosedale/", "representative_set_url": "/representative-sets/ontario-legislature/"}, "email": "JBell-QP@ndp.on.ca", "extra": {}, "district_name": "University\\u2014Rosedale", "name": "Jessica Bell", "elected_office": "MPP", "last_name": "Bell", "url": "https://www.ola.org/en/members/all/jessica-bell", "gender": ""}, {"source_url": "http://www.parl.gc.ca/Parliamentarians/en/members?view=ListAll", "party_name": "Liberal", "personal_url": "http://chrystiafreeland.ca", "first_name": "Chrystia", "offices": [{"tel": "1 613 992-5234", "fax": "1 613 996-9607", "postal": "House of Commons\\nOttawa ON  K1A 0A6", "type": "legislature"}, {"tel": "1 416 928-1451", "fax": "1 416 928-2377", "postal": "344 Bloor Street West (Main Office)\\nSuite 510\\nToronto ON  M5S 3A7", "type": "constituency"}], "representative_set_name": "House of Commons", "photo_url": "http://www.ourcommons.ca/Parliamentarians/Images/OfficialMPPhotos/42/FreelandChrystia_LIB.jpg", "related": {"boundary_url": "/boundaries/federal-electoral-districts/35110/", "representative_set_url": "/representative-sets/house-of-commons/"}, "email": "Chrystia.Freeland@parl.gc.ca", "extra": {}, "district_name": "University\\u2014Rosedale", "name": "Chrystia Freeland", "elected_office": "MP", "last_name": "Freeland", "url": "http://www.parl.gc.ca/Parliamentarians/en/members/Chrystia-Freeland(84665)", "gender": ""}]}`);

describe('repFromRaw()', () => {
  it('should generate a valid contact string (smoketest)', () => {
    const rawRep = json.objects[3];
    const rep = openNorthClient.repFromRaw(rawRep);
    expect(rep.contactString).to.be.equal('You can email them at JBell-QP@ndp.on.ca. You can call their legislature line at 1 416 325-1620 or their constituency line at 1 416 535-7206.');
  });
});
